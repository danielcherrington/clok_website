---
interface Props {
  title: string;
  description?: string;
}

const { title, description = "Clok - Time Tracking Made Simple" } = Astro.props;

// Fetch latest release from GitHub
const response = await fetch('https://api.github.com/repos/Citosoft/clok/releases/latest');
const release = await response.json();
const downloadUrl = release.assets?.[0]?.browser_download_url || 'https://github.com/Citosoft/clok/releases/latest';

const currentPath = Astro.url.pathname;
---

<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width" />
    <link rel="icon" type="image/png" href="/trayicon.png" />
    <meta name="generator" content={Astro.generator} />
    <title>{title}</title>
    <meta name="description" content={description} />
    <link rel="stylesheet" href="https://rsms.me/inter/inter.css">
    <script is:inline>
      // Initialize theme as early as possible
      function initTheme() {
        if (localStorage.theme === 'dark' || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
          document.documentElement.classList.add('dark');
        } else {
          document.documentElement.classList.remove('dark');
        }
      }
      // Run on page load, as early as possible
      initTheme();
      document.addEventListener('DOMContentLoaded', () => {
        const themeToggle = document.getElementById('theme-toggle');
        if (themeToggle) {
          themeToggle.addEventListener('click', () => {
            if (document.documentElement.classList.contains('dark')) {
              document.documentElement.classList.remove('dark');
              localStorage.theme = 'light';
            } else {
              document.documentElement.classList.add('dark');
              localStorage.theme = 'dark';
            }
          });
        }

        // Mobile menu functionality
        const mobileMenuButton = document.getElementById('mobile-menu-button');
        const closeMobileMenu = document.getElementById('close-mobile-menu');
        const mobileMenu = document.getElementById('mobile-menu');
        const mobileMenuContent = mobileMenu?.querySelector('div');

        function toggleMobileMenu() {
          if (mobileMenu && mobileMenuContent) {
            mobileMenu.classList.toggle('hidden');
            setTimeout(() => {
              mobileMenuContent.classList.toggle('translate-x-full');
            }, 10);
          }
        }

        if (mobileMenuButton) {
          mobileMenuButton.addEventListener('click', toggleMobileMenu);
        }

        if (closeMobileMenu) {
          closeMobileMenu.addEventListener('click', toggleMobileMenu);
        }

        // Close mobile menu when clicking outside
        if (mobileMenu) {
          mobileMenu.addEventListener('click', (e) => {
            if (e.target === mobileMenu) {
              toggleMobileMenu();
            }
          });
        }
      });
    </script>
  </head>
  <body class="min-h-screen bg-gradient-to-br from-white to-gray-50 dark:from-slate-900 dark:to-slate-800 transition-colors duration-200 relative">
    <div aria-hidden="true" class="pointer-events-none fixed inset-0 z-0">
      <div class="absolute inset-0 w-full h-full bg-gradient-to-br from-emerald-400/30 via-purple-400/20 to-transparent dark:from-emerald-600/40 dark:via-purple-700/30 blur-3xl opacity-70"></div>
    </div>
    <header class="fixed w-full bg-white/80 dark:bg-slate-900/80 backdrop-blur-sm border-b border-gray-200 dark:border-slate-800 z-50">
      <nav class="container mx-auto px-4 py-4 flex items-center justify-between">
        <a href="/" class="flex items-center gap-2">
          <img src="/trayicon.png" alt="Clok Logo" class="w-8 h-8" />
          <span class="text-2xl font-bold text-gray-900 dark:text-white">Clok</span>
        </a>
        <div class="hidden md:flex items-center space-x-8">
          <a href="/features" class={`text-gray-600 dark:text-gray-300 hover:text-emerald-500 dark:hover:text-emerald-400 transition-colors px-3 py-2 rounded-lg ${currentPath.startsWith('/features') ? 'bg-white/60 dark:bg-slate-900/60 backdrop-blur border border-emerald-400/20 shadow font-semibold pointer-events-none' : ''}`}>Features</a>
          <a href="/pricing" class={`text-gray-600 dark:text-gray-300 hover:text-emerald-500 dark:hover:text-emerald-400 transition-colors px-3 py-2 rounded-lg ${currentPath.startsWith('/pricing') ? 'bg-white/60 dark:bg-slate-900/60 backdrop-blur border border-emerald-400/20 shadow font-semibold pointer-events-none' : ''}`}>Pricing</a>
          <a href="/integrations" class={`text-gray-600 dark:text-gray-300 hover:text-emerald-500 dark:hover:text-emerald-400 transition-colors px-3 py-2 rounded-lg ${currentPath.startsWith('/integrations') ? 'bg-white/60 dark:bg-slate-900/60 backdrop-blur border border-emerald-400/20 shadow font-semibold pointer-events-none' : ''}`}>Integrations</a>
          <a href="/documentation" class={`text-gray-600 dark:text-gray-300 hover:text-emerald-500 dark:hover:text-emerald-400 transition-colors px-3 py-2 rounded-lg ${currentPath.startsWith('/docs') ? 'bg-white/60 dark:bg-slate-900/60 backdrop-blur border border-emerald-400/20 shadow font-semibold pointer-events-none' : ''}`}>Documentation</a>
          <a href="/about" class={`text-gray-600 dark:text-gray-300 hover:text-emerald-500 dark:hover:text-emerald-400 transition-colors px-3 py-2 rounded-lg ${currentPath.startsWith('/about') ? 'bg-white/60 dark:bg-slate-900/60 backdrop-blur border border-emerald-400/20 shadow font-semibold pointer-events-none' : ''}`}>About</a>
          <a href="/releases" class={`text-gray-600 dark:text-gray-300 hover:text-emerald-500 dark:hover:text-emerald-400 transition-colors px-3 py-2 rounded-lg ${currentPath.startsWith('/releases') ? 'bg-white/60 dark:bg-slate-900/60 backdrop-blur border border-emerald-400/20 shadow font-semibold pointer-events-none' : ''}`}>Download</a>
        </div>
        <div class="flex items-center gap-2 ml-4">
          <a href="https://github.com/Citosoft/clok" class="text-gray-600 dark:text-gray-300 hover:text-emerald-500 dark:hover:text-emerald-400 transition-colors" aria-label="GitHub" target="_blank" rel="noopener noreferrer">
            <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true">
              <path d="M12 2C6.477 2 2 6.484 2 12.021c0 4.428 2.865 8.184 6.839 9.504.5.092.682-.217.682-.482 0-.237-.009-.868-.014-1.703-2.782.605-3.369-1.342-3.369-1.342-.454-1.157-1.11-1.465-1.11-1.465-.908-.62.069-.608.069-.608 1.004.07 1.532 1.032 1.532 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.339-2.221-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.029-2.688-.103-.253-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.025A9.564 9.564 0 0112 6.844c.85.004 1.705.115 2.504.337 1.909-1.295 2.748-1.025 2.748-1.025.546 1.378.202 2.397.1 2.65.64.7 1.028 1.595 1.028 2.688 0 3.847-2.337 4.695-4.566 4.944.359.309.678.92.678 1.855 0 1.338-.012 2.419-.012 2.749 0 .267.18.579.688.481C19.138 20.2 22 16.447 22 12.021 22 6.484 17.523 2 12 2z"/>
            </svg>
          </a>
          <button id="theme-toggle" class="p-2 rounded-lg text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-slate-800 transition-colors" aria-label="Toggle theme">
            <svg class="w-5 h-5 hidden dark:block" fill="currentColor" viewBox="0 0 20 20">
              <path d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z"/>
            </svg>
            <svg class="w-5 h-5 block dark:hidden" fill="currentColor" viewBox="0 0 20 20">
              <path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"/>
            </svg>
          </button>
          <!-- Mobile menu button -->
          <button id="mobile-menu-button" class="md:hidden p-2 rounded-lg text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-slate-800 transition-colors" aria-label="Toggle mobile menu">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
            </svg>
          </button>
        </div>
      </nav>
    </header>
    <!-- Mobile menu overlay -->
    <div id="mobile-menu" class="fixed inset-0 bg-black/50 backdrop-blur-sm z-50 hidden">
      <div class="fixed inset-y-0 right-0 w-64 bg-white dark:bg-slate-900 shadow-lg transform translate-x-full transition-transform duration-300 ease-in-out">
        <div class="p-4">
          <button id="close-mobile-menu" class="absolute top-4 right-4 p-2 rounded-lg text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-slate-800 transition-colors" aria-label="Close mobile menu">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
            </svg>
          </button>
          <nav class="mt-8 space-y-4">
            <a href="/features" class={`block text-gray-600 dark:text-gray-300 hover:text-emerald-500 dark:hover:text-emerald-400 transition-colors px-3 py-2 rounded-lg ${currentPath.startsWith('/features') ? 'bg-white/60 dark:bg-slate-900/60 backdrop-blur border border-emerald-400/20 shadow font-semibold pointer-events-none' : ''}`}>Features</a>
            <a href="/pricing" class={`block text-gray-600 dark:text-gray-300 hover:text-emerald-500 dark:hover:text-emerald-400 transition-colors px-3 py-2 rounded-lg ${currentPath.startsWith('/pricing') ? 'bg-white/60 dark:bg-slate-900/60 backdrop-blur border border-emerald-400/20 shadow font-semibold pointer-events-none' : ''}`}>Pricing</a>
            <a href="/integrations" class={`block text-gray-600 dark:text-gray-300 hover:text-emerald-500 dark:hover:text-emerald-400 transition-colors px-3 py-2 rounded-lg ${currentPath.startsWith('/integrations') ? 'bg-white/60 dark:bg-slate-900/60 backdrop-blur border border-emerald-400/20 shadow font-semibold pointer-events-none' : ''}`}>Integrations</a>
            <a href="/docs" class={`block text-gray-600 dark:text-gray-300 hover:text-emerald-500 dark:hover:text-emerald-400 transition-colors px-3 py-2 rounded-lg ${currentPath.startsWith('/docs') ? 'bg-white/60 dark:bg-slate-900/60 backdrop-blur border border-emerald-400/20 shadow font-semibold pointer-events-none' : ''}`}>Documentation</a>
            <a href="/about" class={`block text-gray-600 dark:text-gray-300 hover:text-emerald-500 dark:hover:text-emerald-400 transition-colors px-3 py-2 rounded-lg ${currentPath.startsWith('/about') ? 'bg-white/60 dark:bg-slate-900/60 backdrop-blur border border-emerald-400/20 shadow font-semibold pointer-events-none' : ''}`}>About</a>
            <a href="/releases" class={`block text-gray-600 dark:text-gray-300 hover:text-emerald-500 dark:hover:text-emerald-400 transition-colors px-3 py-2 rounded-lg ${currentPath.startsWith('/releases') ? 'bg-white/60 dark:bg-slate-900/60 backdrop-blur border border-emerald-400/20 shadow font-semibold pointer-events-none' : ''}`}>Download</a>
          </nav>
        </div>
      </div>
    </div>
    <main class="pt-20 relative z-10">
      <slot />
    </main>
    <footer class="bg-gradient-to-br from-gray-50 to-white dark:from-slate-800 dark:to-slate-900 border-t border-gray-200 dark:border-slate-700 mt-20">
      <div class="container mx-auto px-4 py-12">
        <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
          <div>
            <h3 class="text-lg font-semibold bg-gradient-to-r from-emerald-500 to-purple-600 bg-clip-text text-transparent mb-4">Clok</h3>
            <p class="text-gray-600 dark:text-gray-300">Time tracking made simple for teams and individuals.</p>
          </div>
          <div>
            <h4 class="text-sm font-semibold text-gray-900 dark:text-white mb-4">Features</h4>
            <ul class="space-y-2">
              <li><a href="/features#time-tracking" class="text-gray-600 dark:text-gray-300 hover:text-emerald-500 dark:hover:text-emerald-400 transition-colors">Time Tracking</a></li>
              <li><a href="/features#tasks" class="text-gray-600 dark:text-gray-300 hover:text-emerald-500 dark:hover:text-emerald-400 transition-colors">Task Management</a></li>
              <li><a href="/features#reports" class="text-gray-600 dark:text-gray-300 hover:text-emerald-500 dark:hover:text-emerald-400 transition-colors">Reports & Analytics</a></li>
              <li><a href="/features#goals" class="text-gray-600 dark:text-gray-300 hover:text-emerald-500 dark:hover:text-emerald-400 transition-colors">Goals & Targets</a></li>
            </ul>
          </div>
          <div>
            <h4 class="text-sm font-semibold text-gray-900 dark:text-white mb-4">Integrations</h4>
            <ul class="space-y-2">
              <li><a href="/integrations#sugarcrm" class="text-gray-600 dark:text-gray-300 hover:text-emerald-500 dark:hover:text-emerald-400 transition-colors">SugarCRM</a></li>
              <li><a href="/integrations#espocrm" class="text-gray-600 dark:text-gray-300 hover:text-emerald-500 dark:hover:text-emerald-400 transition-colors">EspoCRM</a></li>
              <li><a href="/integrations#citohr" class="text-gray-600 dark:text-gray-300 hover:text-emerald-500 dark:hover:text-emerald-400 transition-colors">CitoHR</a></li>
              <li><a href="/integrations#google-sheets" class="text-gray-600 dark:text-gray-300 hover:text-emerald-500 dark:hover:text-emerald-400 transition-colors">Google Sheets</a></li>
            </ul>
          </div>
          <div>
            <h4 class="text-sm font-semibold text-gray-900 dark:text-white mb-4">Legal</h4>
            <ul class="space-y-2">
              <li><a href="/privacy" class="text-gray-600 dark:text-gray-300 hover:text-emerald-500 dark:hover:text-emerald-400 transition-colors">Privacy Policy</a></li>
              <li><a href="/terms" class="text-gray-600 dark:text-gray-300 hover:text-emerald-500 dark:hover:text-emerald-400 transition-colors">Terms of Service</a></li>
            </ul>
          </div>
        </div>
        <div class="mt-8 pt-8 border-t border-gray-200 dark:border-slate-700 text-center text-gray-600 dark:text-gray-400">
          <p>&copy; {new Date().getFullYear()} Clok. All rights reserved.</p>
        </div>
      </div>
    </footer>
  </body>
</html> 